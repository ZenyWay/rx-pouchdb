(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
"use strict";function destroy(e){return function(){return e.destroy().then(debug("example:destroy:done")).catch(debug("example:destroy:err"))}}var src_1=require("../../src"),debug=require("debug"),PouchDB=require("pouchdb-browser");debug.enable("example:*,rx-pouchdb:*");var db=new PouchDB("sids"),sids=src_1.default(db,{read:{include_docs:!0}}),docs=[{_id:"hubbard-rob_monty-on-the-run",title:"Monty on the Run",author:"Rob Hubbard",release:"1985"},[{_id:"hubbard-rob_sanxion",title:"Sanxion",author:"Rob Hubbard",release:"1986"},{_id:"tel-jeroen_ikari-union",title:"Ikari Union",author:"Jeroen Tel",release:"1987"}]],refs=sids.write(docs);sids.read(refs).subscribe(debug("example:read:next"),destroy(db),destroy(db));
},{"../../src":4,"debug":undefined,"pouchdb-browser":undefined}],2:[function(require,module,exports){
"use strict";function coreDbIoKeyFor(e){return!e||utils_1.isString(e._id)?"unit":"bulk"}function isPouchDbLike(e){return utils_1.isObject(e)&&["get","put","allDocs","bulkDocs"].every(function(r){return utils_1.isFunction(e[r])})}function isValidDocRefOrRevs(e){return isValidDocRef(e)&&(!e._revs||utils_1.isString(e._revs)||Array.isArray(e._revs))}function isValidDocRef(e){return isValidDocId(e)&&(!e._rev||utils_1.isString(e._rev))}function isValidDocId(e){return utils_1.isObject(e)&&utils_1.isString(e._id)}function isValidDocRefArray(e){return Array.isArray(e)&&e.every(function(e){return isValidDocRef(e)})}function isValidDocIdRange(e){return utils_1.isObject(e)&&utils_1.isString(e.startkey)&&utils_1.isString(e.endkey)}function unitOptsFrom(e){return utils_1.isString(e._rev)?{rev:e._rev}:{revs:e._revs}}function bulkOptsFrom(e){return Array.isArray(e)?{keys:e.map(function(e){return e._id})}:e}function toDocRefs(e){return e.map(toDocRef)}function toDocRef(e){return e.ok?{_id:e.id,_rev:e.rev}:e}function docsFromRevs(e){return Array.isArray(e)?e.map(function(e){return e.ok}):e}var Promise=require("bluebird"),assert=require("assert"),tslib_1=require("tslib"),utils_1=require("./utils"),CoreDbIoClass=function(){function e(e){this.db=e}return Object.defineProperty(e,"factories",{get:function(){return{write:CoreDbWriteClass.newInstance,read:CoreDbReadClass.newInstance}},enumerable:!0,configurable:!0}),e.prototype.access=function(e){var r=coreDbIoKeyFor(e),t=this[r].bind(this);return Promise.try(function(){return t(e)})},e}();CoreDbIoClass.newInstance=function(e){assert(isPouchDbLike(e.db),"invalid PouchDB instance");var r=CoreDbIoClass.factories[e.type];return r(e)},CoreDbIoClass.isCoreDbIoLike=function(e){return utils_1.isObject(e)&&utils_1.isFunction(e.access)};var CoreDbWriteClass=function(e){function r(r,t){var i=e.call(this,r)||this;return i.spec=t,i}return __extends(r,e),r.prototype.unit=function(e){return assert(isValidDocRef(e),"invalid document"),this.db.put(e,this.spec).then(toDocRef)},r.prototype.bulk=function(e){return assert(isValidDocRefArray(e),"invalid document"),this.db.bulkDocs(e,this.spec).then(toDocRefs)},r}(CoreDbIoClass);CoreDbWriteClass.newInstance=function(e){return new CoreDbWriteClass(e.db,e.opts)};var CoreDbReadClass=function(e){function r(r,t){var i=e.call(this,r)||this;return i.spec=t,i}return __extends(r,e),r.prototype.unit=function(e){assert(isValidDocRefOrRevs(e),"invalid document reference");var r=tslib_1.__assign({},this.spec,unitOptsFrom(e));return this.db.get(e._id,r).then(docsFromRevs)},r.prototype.bulk=function(e){assert(isValidDocRefArray(e)||isValidDocIdRange(e),"invalid document reference");var r=tslib_1.__assign({},this.spec,bulkOptsFrom(e));return this.db.allDocs(r).then(function(e){return e.rows.map(function(e){return e.doc})})},r}(CoreDbIoClass);CoreDbReadClass.newInstance=function(e){return new CoreDbReadClass(e.db,e.opts)},exports.isCoreDbIoLike=CoreDbIoClass.isCoreDbIoLike;var newCoreDbIo=CoreDbIoClass.newInstance;Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=newCoreDbIo;
},{"./utils":5,"assert":undefined,"bluebird":undefined,"tslib":undefined}],3:[function(require,module,exports){
"use strict";function getCoreDbIo(e,r,o){return core_db_io_1.isCoreDbIoLike(o)?o:core_db_io_1.default({db:e,type:r,opts:o})}var rxjs_1=require("rxjs"),core_db_io_1=require("./core-db-io"),utils_1=require("./utils"),DbIoClass=function(){function e(e){this.coreDbIo=e}return e.prototype.write=function(e){return rxjs_1.Observable.fromPromise(Promise.resolve(this.coreDbIo.write.access(e)))},e.prototype.read=function(e){return rxjs_1.Observable.fromPromise(Promise.resolve(this.coreDbIo.read.access(e)))},e}();DbIoClass.newInstance=function(e,r){var o={write:getCoreDbIo(e,"write",r.coreDbIo||r.write),read:getCoreDbIo(e,"read",r.coreDbIo||r.read)};return new DbIoClass(o)},DbIoClass.isDbIoLike=function(e){return utils_1.isObject(e)&&utils_1.isFunction(e.write)&&utils_1.isFunction(e.read)},exports.isDbIoLike=DbIoClass.isDbIoLike;var newDbIo=DbIoClass.newInstance;Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=newDbIo;
},{"./core-db-io":2,"./utils":5,"rxjs":undefined}],4:[function(require,module,exports){
"use strict";function isValidFactoryOpts(e){return!e||utils_1.isObject(e)&&(!e.dbIo||db_io_1.isDbIoLike(e.dbIo))}function dbIoFactorySpecFrom(e){return{read:tslib_1.__assign({},RxPouchDbClass.newInstance.defaults.read,e&&e.read),write:tslib_1.__assign({},RxPouchDbClass.newInstance.defaults.write,e&&e.write)}}function toObservable(e){try{return rxjs_1.Observable.from(e)}catch(e){return rxjs_1.Observable.throw(e)}}var Promise=require("bluebird"),rxjs_1=require("rxjs"),assert=require("assert"),tslib_1=require("tslib"),db_io_1=require("./db-io"),utils_1=require("./utils"),RxPouchDbClass=function(){function e(e){this.dbIo=e}return e.prototype.write=function(e){return this.access("write",e)},e.prototype.read=function(e){return this.access("read",e)},e.prototype.access=function(e,r){var t=toObservable(r).do(utils_1.logRx("rx-pouchdb:"+e+":src"));return this.dbIo.switchMap(function(r){return t.concatMap(function(t){return r[e](t)})}).do(utils_1.logRx("rx-pouchdb:"+e))},e}();RxPouchDbClass.newInstance=function(e,r){assert(utils_1.isObject(e)&&isValidFactoryOpts(r),"invalid argument");var t=r&&r.dbIo?Promise.resolve(r.dbIo):Promise.try(function(){return db_io_1.default(e,dbIoFactorySpecFrom(r))});return new RxPouchDbClass(rxjs_1.Observable.from(t))},RxPouchDbClass.newInstance.defaults={read:{revs:!1,revs_info:!1,conflicts:!1,attachments:!1,binary:!1,include_docs:!1},write:{}};var getRxPouchDb=RxPouchDbClass.newInstance;Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=getRxPouchDb;
},{"./db-io":3,"./utils":5,"assert":undefined,"bluebird":undefined,"rxjs":undefined,"tslib":undefined}],5:[function(require,module,exports){
"use strict";function isObject(t){return!!t&&"object"==typeof t}function isFunction(t){return"function"==typeof t}function isString(t){return"string"==typeof t}function logRx(t){return{next:debug(t+":next"),error:debug(t+":err"),complete:function(){return debug(t+":done")("")}}}var debug=require("debug");exports.isObject=isObject,exports.isFunction=isFunction,exports.isString=isString,exports.logRx=logRx;

},{"debug":undefined}]},{},[1]);
